import{d as re,r as m,s as se,a as G,o as d,c as v,e as o,w as l,f as a,t as L,F as N,v as ne,x as ie,i as s,y as n,b as C,z as O,A as I,B as ue,E as R,C as me,h as de,l as pe,m as ce,D as be,g as fe,q as A,G as ve,H as _e,I as ge,J as ye,K as he,_ as Se}from"./index-3a9c1492.js";import{m as Ce,a as ke,b as xe,c as Ne,d as we,s as Ve}from"./index-c7f60b37.js";import{I as Ie}from"./index-c28e4fd9.js";/* empty css                             */import{R as Pe}from"./index-ecab751f.js";const Te={class:"flex justify-center"},Ee={class:"flex"},Me={class:"flex justify-end mt-10"},De={class:"flex justify-between flex-wrap overflow-auto px-6 py-6 combo-list"},qe=["onClick"],je={class:"flex justify-end mt-10"},Be=re({__name:"overview",setup(Ue){const P=m({type:[{text:"企业",value:0},{text:"个体",value:1}],grade:[{text:"二级",value:2}],merCombo:[]}),p=m({pageNumber:1,pageSize:10,merName:"",likPhone:"",merType:"",merSuperior:"",status:""});let k=m(1),T=m(0);const E=m([]),F=r=>{Object.keys(r).length?(Object.keys(r).forEach(t=>{Object.keys(p.value).includes(t)&&(p.value[t]=r[t])}),p.value.pageNumber=k.value=1):(k.value=1,p.value={pageNumber:1,pageSize:10,merName:"",likPhone:"",merType:"",merSuperior:"",status:""}),_()},_=async()=>{const r=await Ce({...p.value});r&&(E.value=r.list,T=r.total)};_();const z=se(()=>function(r){switch(r){case"3":return"担保商户";case"4":return"免押商户";case"9":return"个体普通用户"}}),H=r=>{p.value.pageNumber=k.value=r,_()},J=m([{label:"商户名称",value:"",key:"merName",type:"input"},{label:"手机号",value:"",key:"likPhone",type:"input"},{label:"商户类型",value:"",key:"merType",type:"select",options:[{label:"个体",value:"1"},{label:"企业",value:"0"}]},{label:"上级商户",value:"",key:"merSuperior",type:"input"},{label:"状态",value:"",key:"status",type:"select",options:[{label:"禁用",value:"1"},{label:"启用",value:"0"}]}]),K=G([{label:"商户名称",prop:"merName",slot:"merNameSlot"},{label:"联系人",prop:"likName",slot:"likNameSlot"},{label:"手机号",prop:"likPhone",width:"120px",slot:"likPhoneSlot"},{label:"商户类型",prop:"merType",slot:"merTypeSlot"},{label:"商户地址",prop:"merAddress",slot:"merAddressSlot"},{label:"商户logo",prop:"merLogo",slot:"merLogoSlot"},{label:"商户信用等级",prop:"merCredit",width:"120px",slot:"merCreditSlot"},{label:"商户等级",prop:"grade",slot:"gradeSlot"},{label:"上级商户",prop:"merSuperior",slot:"merSuperiorSlot"},{label:"邀请码",prop:"invitationCode",slot:"invitationCodeSlot"},{label:"状态",prop:"status",slot:"statusSlot"},{label:"注册时间",prop:"registerTime",width:"180px",slot:"registerTimeSlot"},{label:"修改时间",prop:"utime",width:"180px",slot:"utimeSlot"},{label:"操作",prop:"edit",width:"200px",slot:"editSlot",attrs:{fixed:"right"}}]),g=m(!1),c=m(!1),M=m(),u=m({merName:"",likName:"",likPhone:"",merType:"",merGrade:2}),Q=G({merName:[{required:!0,trigger:"blur",message:"请输入商户名称"}],likName:[{required:!0,trigger:"blur",message:"请输入联系人"}],likPhone:[{required:!0,trigger:"blur",message:"请输入联系电话"}],merType:[{required:!0,trigger:"change",message:"请选择商户类型"}],merGrade:[{required:!0,trigger:"change",message:"请选择商户等级"}]}),W=async r=>{const t=await ke({id:r.id});Object.keys(t).forEach(i=>{Object.keys(u.value).includes(i)&&(u.value[i]=t[i])}),g.value=c.value=!0},X=async r=>{r&&await r.validate(async(t,i)=>{if(t){const f=g.value?await xe({...u.value}):await Ne({...u.value});f==="请求成功"&&(R({title:`${g.value?"修改":"新增"}成功`,message:f,type:"success",showClose:!1,duration:2*1e3}),_(),w())}else console.log("error submit!",i)})},w=()=>{g.value=c.value=!1},D=m(0),y=m(!1),q=m([]),Y=(r,t)=>{D.value=t,b.value.comboId=r.id},b=m({comboId:0,merId:0}),Z=async r=>{var i;b.value.merId=r.id;const t=await we();b.value.comboId=(i=t[0])==null?void 0:i.id,q.value=t,y.value=!0},V=()=>{y.value=!1,b.value={comboId:0,merId:0}},ee=async()=>{if(!b.value.comboId){me({message:"您还未选择套餐，请选择",type:"error",duration:2*1e3});return}const r=await Ve({...b.value});r==="请求成功"&&(R({title:"绑定成功",message:r,type:"success",showClose:!1,duration:2*1e3}),_(),V())};return(r,t)=>{const i=de,f=pe,h=ce,j=ve,B=be,le=fe,U=ne,S=_e,te=ge,oe=ye,ae=he;return d(),v(N,null,[o(Ie,{inquireInfo:a(J),title:"商户概览",onGetChildren:F},{btnSlot:l(()=>[o(i,{type:"primary",plain:"",onClick:t[0]||(t[0]=ie(e=>c.value=!0,["stop"]))},{default:l(()=>[s("二级商户新增")]),_:1})]),_:1},8,["inquireInfo"]),o(Pe,{option:a(K),tableData:a(E),total:a(T),onPageChange:H,currentPage:a(k)},{merNameSlot:l(({row:e})=>[s(n(e.merName||"--"),1)]),likNameSlot:l(({row:e})=>[s(n(e.likName||"--"),1)]),likPhoneSlot:l(({row:e})=>[s(n(e.likPhone||"--"),1)]),merTypeSlot:l(({row:e})=>[s(n(e.merType?"个体":"企业"),1)]),merAddressSlot:l(({row:e})=>[s(n(e.merAddress||"--"),1)]),merLogoSlot:l(({row:e})=>[s(n(e.merLogo||"--"),1)]),merCreditSlot:l(({row:e})=>[s(n(a(z)(e.merCredit)||"--"),1)]),gradeSlot:l(({row:e})=>[s(n(e.grade||"--"),1)]),merSuperiorSlot:l(({row:e})=>[s(n(e.merSuperior||"--"),1)]),invitationCodeSlot:l(({row:e})=>[s(n(e.invitationCode||"--"),1)]),statusSlot:l(({row:e})=>[C("span",{class:O(e.status?"text-red-400 ":"text-green-400")},n(e.status?"禁用":"启用"),3)]),registerTimeSlot:l(({row:e})=>[s(n(e.registerTime||"--"),1)]),utimeSlot:l(({row:e})=>[s(n(e.utime||"--"),1)]),editSlot:l(({row:e,index:x})=>[C("div",Te,[o(i,{onClick:$=>W(e),type:"primary",plain:""},{default:l(()=>[s("修改")]),_:2},1032,["onClick"]),o(i,{onClick:$=>Z(e),type:"primary",plain:""},{default:l(()=>[s("绑定套餐")]),_:2},1032,["onClick"])])]),_:1},8,["option","tableData","total","currentPage"]),o(U,{modelValue:a(c),"onUpdate:modelValue":t[7]||(t[7]=e=>L(c)?c.value=e:null),title:`${a(g)?"修改":"新增"}二级商户`,width:"500px",onClosed:w},{default:l(()=>[o(le,{model:a(u),rules:a(Q),ref_key:"subMerchantRef",ref:M,"label-position":"left","label-width":"100px"},{default:l(()=>[o(h,{prop:"merName",label:"商户名称"},{default:l(()=>[o(f,{modelValue:a(u).merName,"onUpdate:modelValue":t[1]||(t[1]=e=>a(u).merName=e),modelModifiers:{number:!0},placeholder:"请输入商户名称"},null,8,["modelValue"])]),_:1}),o(h,{prop:"likName",label:"联系人"},{default:l(()=>[o(f,{modelValue:a(u).likName,"onUpdate:modelValue":t[2]||(t[2]=e=>a(u).likName=e),modelModifiers:{number:!0},placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1}),o(h,{prop:"likPhone",label:"联系电话"},{default:l(()=>[o(f,{modelValue:a(u).likPhone,"onUpdate:modelValue":t[3]||(t[3]=e=>a(u).likPhone=e),modelModifiers:{number:!0},maxlength:"11",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),o(h,{prop:"merGrade",label:"商户等级"},{default:l(()=>[o(B,{modelValue:a(u).merGrade,"onUpdate:modelValue":t[4]||(t[4]=e=>a(u).merGrade=e),placeholder:"请选择商户类型",disabled:""},{default:l(()=>[(d(!0),v(N,null,I(a(P).grade,e=>(d(),A(j,{key:e.value,label:e.text,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(h,{prop:"merType",label:"商户类型"},{default:l(()=>[C("div",Ee,[o(B,{modelValue:a(u).merType,"onUpdate:modelValue":t[5]||(t[5]=e=>a(u).merType=e),placeholder:"请选择商户类型"},{default:l(()=>[(d(!0),v(N,null,I(a(P).type,e=>(d(),A(j,{key:e.value,label:e.text,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["model","rules"]),C("div",Me,[o(i,{type:"info",plain:"",onClick:w},{default:l(()=>[s("取消")]),_:1}),o(i,{type:"primary",plain:"",onClick:t[6]||(t[6]=e=>X(a(M)))},{default:l(()=>[s("确定")]),_:1})])]),_:1},8,["modelValue","title"]),o(U,{modelValue:a(y),"onUpdate:modelValue":t[9]||(t[9]=e=>L(y)?y.value=e:null),title:"绑定商户套餐",width:"900px",onClosed:V},{default:l(()=>[ue((d(),v("ul",De,[(d(!0),v(N,null,I(a(q),(e,x)=>(d(),v("li",{class:"w-5/12 mb-4 h-96 select-none",key:x,onClick:$=>Y(e,x)},[o(oe,{class:O(["cursor-pointer h-full desc-card wrap",a(D)===x?"select-card":""]),shadow:"hover"},{default:l(()=>[o(te,{title:"套餐信息",direction:"vertical",border:"",column:2},{default:l(()=>[o(S,{label:"名称"},{default:l(()=>[s(n(e.comboInfo||"--"),1)]),_:2},1024),o(S,{label:"类型"},{default:l(()=>[s(n(e.comboType),1)]),_:2},1024),o(S,{label:"金额"},{default:l(()=>[s(n(e.comboMoney||"--"),1)]),_:2},1024),o(S,{label:"可用次数"},{default:l(()=>[s(n(e.comboCount||0),1)]),_:2},1024),o(S,{label:"创建时间"},{default:l(()=>[s(n(e.ctime),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],8,qe))),128))])),[[ae,e=>{}]]),C("div",je,[o(i,{type:"info",plain:"",onClick:V},{default:l(()=>[s("取消")]),_:1}),o(i,{type:"primary",plain:"",onClick:t[8]||(t[8]=e=>ee())},{default:l(()=>[s("确定")]),_:1})])]),_:1},8,["modelValue"])],64)}}});const Ae=Se(Be,[["__scopeId","data-v-12742dbc"]]);export{Ae as default};
