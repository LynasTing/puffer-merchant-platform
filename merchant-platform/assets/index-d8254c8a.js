import{L as v,d as fe,r as c,a as Q,s as H,o as m,c as w,e as a,w as o,f as r,t as J,F as T,v as ve,i as n,y as i,b as I,z as K,M as W,B as X,N as ye,A as V,q as k,O as _e,E,C as ge,h as we,P as Ce,l as he,m as Se,D as Ne,g as Re,G as xe,H as Pe,I as Te,J as Ie,K as Ve,_ as ke}from"./index-3a9c1492.js";import{d as Ee}from"./index-c7f60b37.js";import{I as De}from"./index-c28e4fd9.js";/* empty css                             */import{R as Oe}from"./index-ecab751f.js";const Ue=u=>v({url:"/mer/merRiderPageQuery",data:u}),qe=u=>v({url:"/mer/riderSave",data:u}),$e=u=>v({url:"/mer/merRideEcho",data:u}),je=u=>v({url:"/mer/riderUpdate",data:u}),Me=u=>v({url:"/mer/riderPersonal",data:u}),ze=u=>v({url:"/mer/riderMerEnd",data:u}),Fe=u=>v({url:"/mer/riderComboSave",data:u}),Be=u=>v({url:"mer/riderRenew",data:u}),Le={class:"flex items-center"},Ae={class:"flex justify-end mt-10"},Ge={class:"flex justify-between flex-wrap overflow-auto px-6 py-6 combo-list"},Qe=["onClick"],He={class:"flex justify-end mt-10"},Je=fe({__name:"index",setup(u){const C=c({renew:[{label:"开启",value:1},{label:"关闭",value:2}],type:[{label:"普通",value:1},{label:"免押",value:2},{label:"担保",value:3}],combo:[]});let y=c(1);const Y=t=>{Object.keys(t).length?(Object.keys(t).forEach(l=>{Object.keys(p.value).includes(l)&&(p.value[l]=t[l])}),p.value.pageNumber=y.value=1):(y.value=1,p.value={pageNumber:1,pageSize:10,riderName:"",riderPhone:"",riderType:""}),_()},Z=t=>{p.value.pageNumber=y.value=t,_()},ee=c([{label:"骑手姓名",value:"",key:"riderName",type:"input"},{label:"骑手手机号",value:"",key:"riderPhone",type:"input"},{label:"骑手类型",value:"",key:"riderType",options:C.value.type,type:"select"}]),M=c(-1),z=c([]),oe=Q([{label:"骑手名称",prop:"riderName",slot:"riderNameSlot"},{label:"骑手电话",prop:"riderPhone",width:"160px",slot:"riderPhoneSlot"},{label:"骑手类型",prop:"riderType",slot:"riderTypeSlot"},{label:"是否自动续费",prop:"comboRenew",width:"120px",slot:"comboRenewSlot"},{label:"套餐名称",prop:"comboName",width:"160px",slot:"comboNameSlot"},{label:"套餐类型",prop:"comboType",slot:"comboTypeSlot"},{label:"套餐金额",prop:"buyMoney",slot:"buyMoneySlot"},{label:"套餐有效期",prop:"comboValidTime",slot:"comboValidTimeSlot"},{label:"套餐次数",prop:"comboCount",slot:"comboCountSlot"},{label:"电池ID",prop:"batteryId",slot:"batteryIdSlot"},{label:"押金状态",prop:"isDeposit",slot:"isDepositSlot"},{label:"实名认证状态",prop:"isRealName",width:"140px",slot:"isRealNameSlot"},{label:"用户状态",prop:"status",slot:"statusSlot"},{label:"注册时间",prop:"registerTime",width:"170px",slot:"registerTimeSlot"},{label:"操作",prop:"edit",width:"430px",slot:"editSlot",attrs:{fixed:"right"}}]),p=c({pageNumber:1,pageSize:10,riderName:"",riderPhone:"",riderType:""}),_=async()=>{const t=await Ue({...p.value});if(t){const{total:l,list:s}=t;z.value=s,M.value=l}};_();const le=H(()=>function(t){switch(t){case 1:return"普通";case 2:return"免押";case 3:return"担保"}}),te=H(()=>function(t){switch(t){case 1:return"按月";case 2:return"按天";case 3:return"按次";case 4:return"自定义"}}),b=c(-1),h=c(!1),D=c(),d=c({riderName:"",riderPhone:"",riderType:"",comboRenew:1,comboId:""}),ae=Q({riderName:[{required:!0,trigger:"blur",message:"请输入骑手姓名"},{min:2,max:12,message:"请输入2~12个字长"}],riderPhone:[{required:!0,trigger:"blur",message:"请输入骑手电话号"}],riderType:[{required:!0,trigger:"change",message:"请选择骑手类型"}],comboRenew:[{required:!0,trigger:"change",message:"请选择是否自动续费"}],comboId:[{required:!0,trigger:"change",message:"请选择要绑定的套餐"}]}),F=async()=>{b.value===-1&&await B(),h.value=!0},re=async t=>{const l=await $e({id:t.id});Object.keys(l).forEach(s=>{Object.keys(d.value).includes(s)&&(d.value[s]=l[s])}),b.value=t.id,F()},B=async()=>{const t=await Ee();C.value.combo=t};B();const O=()=>{var t;h.value=!1,b.value=-1,(t=D.value)==null||t.resetFields()},ne=async t=>{t&&await t.validate(async(l,s)=>{if(l){const R=b.value?await je({...d.value,id:b.value}):await qe({...d.value});R==="请求成功"&&(E({title:`${b.value?"修改":"新增"}成功`,message:R,type:"success",showClose:!1,duration:2*1e3}),p.value.pageNumber=y.value=1,_(),O())}else console.log("error submit!",s)})},S=c(-1),N=c(!1),U=c(""),g=c({comboId:-1,riderName:"",riderPhone:"",merCode:"",accountUid:""}),L=async(t,l)=>{Object.keys(t).forEach(s=>{Object.keys(g.value).includes(s)&&(g.value[s]=t[s])}),U.value=l,N.value=!0},se=async()=>{if(S.value===-1){ge.error("请您先选择套餐!");return}g.value.comboId=S.value;const t=U.value==="修改"?await Fe({...g.value}):await Be({...g.value});t==="请求成功"&&(E({title:"操作成功",message:t,type:"success",showClose:!1,duration:1.5*1e3}),_(),q())},ie=(t,l)=>{S.value=l,g.value.comboId=t.id},q=()=>{N.value=!1,S.value=-1,g.value={comboId:-1,riderName:"",riderPhone:"",merCode:"",accountUid:""}},ue=async t=>{const l=await Me({accountUid:t.accountUid,merCode:t.merCode});l==="请求成功"&&(E({title:l,message:l,type:"success",showClose:!1,duration:2*1e3}),p.value.pageNumber=y.value=1,_())},de=async t=>{const l=await ze({accountUid:t.accountUid});l==="请求成功"&&(E({title:l,message:l,type:"success",showClose:!1,duration:2*1e3}),p.value.pageNumber=y.value=1,_())};return(t,l)=>{const s=we,R=Ce,A=he,x=Se,$=xe,j=Ne,ce=Re,G=ve,P=Pe,me=Te,pe=Ie,be=Ve;return m(),w(T,null,[a(De,{inquireInfo:r(ee),title:"骑手概览",onGetChildren:Y},{btnSlot:o(()=>[a(s,{type:"primary",plain:"",onClick:F},{default:o(()=>[n("新增骑手")]),_:1})]),_:1},8,["inquireInfo"]),a(Oe,{option:r(oe),tableData:r(z),total:r(M),onPageChange:Z,currentPage:r(y)},{riderNameSlot:o(({row:e})=>[n(i(e.riderName||"--"),1)]),riderPhoneSlot:o(({row:e})=>[n(i(e.riderPhone||"--"),1)]),riderTypeSlot:o(({row:e})=>[n(i(r(le)(e.riderType)||"--"),1)]),comboRenewSlot:o(({row:e})=>[n(i(e.comboRenew?"是":"否"),1)]),comboNameSlot:o(({row:e})=>[n(i(e.comboName||"--"),1)]),comboTypeSlot:o(({row:e})=>[n(i(r(te)(e.comboType)),1)]),buyMoneySlot:o(({row:e})=>[n(i(e.buyMoney||"--"),1)]),comboValidTimeSlot:o(({row:e})=>[n(i(e.comboValidTime||"--"),1)]),comboCountSlot:o(({row:e})=>[n(i(e.comboCount||"--"),1)]),batteryIdSlot:o(({row:e})=>[n(i(e.batteryId||"--"),1)]),isDepositSlot:o(({row:e})=>[n(i(e.isDeposit?"已缴纳":"未缴纳"),1)]),isRealNameSlot:o(({row:e})=>[n(i(e.isRealName?"已实名":"未实名"),1)]),statusSlot:o(({row:e})=>[I("span",{class:K(e.status?"text-red-400":"text-green-400")},i(e.status?"冻结":"正常"),3)]),registerTimeSlot:o(({row:e})=>[n(i(e.registerTime||"--"),1)]),editSlot:o(({row:e})=>[I("div",Le,[a(s,{onClick:f=>re(e),size:"small",type:"primary",plain:""},{default:o(()=>[n("编辑")]),_:2},1032,["onClick"]),a(R,{width:"220","confirm-button-text":"确定","cancel-button-text":"取消",icon:r(W),"icon-color":"#626AEF","hide-after":50,title:"确定将用户转为个人骑手吗?",onConfirm:f=>ue(e)},{reference:o(()=>[a(s,{size:"small",type:"warning",plain:""},{default:o(()=>[n("转个人骑手")]),_:1})]),_:2},1032,["icon","onConfirm"]),a(R,{width:"220","confirm-button-text":"确定","cancel-button-text":"取消",icon:r(W),"icon-color":"#626AEF","hide-after":50,title:"确定将用户套餐终止吗?",onConfirm:f=>de(e)},{reference:o(()=>[a(s,{size:"small",type:"danger",plain:""},{default:o(()=>[n("终止套餐")]),_:1})]),_:2},1032,["icon","onConfirm"]),a(s,{onClick:f=>L(e,"修改"),size:"small",type:"warning",plain:""},{default:o(()=>[n("套餐修改")]),_:2},1032,["onClick"]),X(a(s,{onClick:f=>L(e,"续费"),size:"small",type:"primary",plain:""},{default:o(()=>[n("套餐续费")]),_:2},1032,["onClick"]),[[ye,e.comboId]])])]),_:1},8,["option","tableData","total","currentPage"]),a(G,{modelValue:r(h),"onUpdate:modelValue":l[6]||(l[6]=e=>J(h)?h.value=e:null),title:`${r(b)?"修改":"新增"}骑手`,width:"500px",onClosed:O},{default:o(()=>[a(ce,{model:r(d),rules:r(ae),ref_key:"riderRef",ref:D,"scroll-to-error":!0,"label-position":"left","label-width":"130px"},{default:o(()=>[a(x,{prop:"riderName",label:"骑手姓名"},{default:o(()=>[a(A,{modelValue:r(d).riderName,"onUpdate:modelValue":l[0]||(l[0]=e=>r(d).riderName=e),placeholder:"请输入骑手姓名","max-length":"12"},null,8,["modelValue"])]),_:1}),a(x,{prop:"riderPhone",label:"手机号"},{default:o(()=>[a(A,{modelValue:r(d).riderPhone,"onUpdate:modelValue":l[1]||(l[1]=e=>r(d).riderPhone=e),modelModifiers:{number:!0},maxlength:"11",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",placeholder:"请输入骑手手机号码"},null,8,["modelValue"])]),_:1}),a(x,{prop:"riderType",label:"骑手类型"},{default:o(()=>[a(j,{modelValue:r(d).riderType,"onUpdate:modelValue":l[2]||(l[2]=e=>r(d).riderType=e),placeholder:"请选择骑手类型"},{default:o(()=>[(m(!0),w(T,null,V(r(C).type,e=>(m(),k($,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(x,{prop:"comboRenew",label:"是否自动续费"},{default:o(()=>[a(j,{modelValue:r(d).comboRenew,"onUpdate:modelValue":l[3]||(l[3]=e=>r(d).comboRenew=e),placeholder:"请选择是否自动续费"},{default:o(()=>[(m(!0),w(T,null,V(r(C).renew,e=>(m(),k($,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(b)==-1?(m(),k(x,{key:0,prop:"comboId",label:"绑定套餐"},{default:o(()=>[a(j,{modelValue:r(d).comboId,"onUpdate:modelValue":l[4]||(l[4]=e=>r(d).comboId=e),placeholder:"请选择绑定套餐"},{default:o(()=>[(m(!0),w(T,null,V(r(C).combo,e=>(m(),k($,{key:e.id,label:e.comboInfo,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):_e("",!0),I("div",Ae,[a(s,{type:"info",plain:"",onClick:O},{default:o(()=>[n("取消")]),_:1}),a(s,{type:"primary",plain:"",onClick:l[5]||(l[5]=e=>ne(r(D)))},{default:o(()=>[n("确定")]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(G,{modelValue:r(N),"onUpdate:modelValue":l[8]||(l[8]=e=>J(N)?N.value=e:null),title:`套餐${r(U)}`,width:"900px",onClosed:q},{default:o(()=>[X((m(),w("ul",Ge,[(m(!0),w(T,null,V(r(C).combo,(e,f)=>(m(),w("li",{class:"w-5/12 mb-4 h-96 select-none",key:f,onClick:Ke=>ie(e,f)},[a(pe,{class:K(["cursor-pointer h-full desc-card wrap",r(S)===f?"select-card":""]),shadow:"hover"},{default:o(()=>[a(me,{title:"套餐信息",direction:"vertical",border:"",column:2},{default:o(()=>[a(P,{label:"名称"},{default:o(()=>[n(i(e.comboInfo||"--"),1)]),_:2},1024),a(P,{label:"类型"},{default:o(()=>[n(i(e.comboType),1)]),_:2},1024),a(P,{label:"金额"},{default:o(()=>[n(i(e.comboMoney||"--"),1)]),_:2},1024),a(P,{label:"可用次数"},{default:o(()=>[n(i(e.comboCount||0),1)]),_:2},1024),a(P,{label:"创建时间"},{default:o(()=>[n(i(e.ctime),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],8,Qe))),128))])),[[be,e=>{}]]),I("div",He,[a(s,{type:"info",plain:"",onClick:q},{default:o(()=>[n("取消")]),_:1}),a(s,{type:"primary",plain:"",onClick:l[7]||(l[7]=e=>se())},{default:o(()=>[n("确定")]),_:1})])]),_:1},8,["modelValue","title"])],64)}}});const oo=ke(Je,[["__scopeId","data-v-28ec5ee9"]]);export{oo as default};
